#!/usr/bin/env python

 
import rospy
import numpy as np
import time
from sensor_msgs.msg import Joy

from follow_joint_trajectory_action_adapter import FollowJointTrajectoryActionAdapter 

joy_vel = 0

def joy_cb(data):
    global joy_vel
    
    if data.buttons[0] != 0:
        joy_vel = 0.25 * data.axes[1] 
    elif data.buttons[1] != 0:
        joy_vel = data.axes[1]
    else:
        joy_vel = 0    

def main():
    rospy.init_node("test_follow_joint_trajectory_action_adapter")
    
    rospy.Subscriber("joy", Joy, joy_cb)
    
    trajectory = FollowJointTrajectoryActionAdapter()
    joint_angles=np.zeros(6)
        
    r = rospy.Rate(250)
    while True:           
        trajectory.current_joint_angles = joint_angles         
        res, joint_angles1 = trajectory.increment_trajectory_time(4e-3 * joy_vel)
        if res:            
            joint_angles = joint_angles1
        
        r.sleep()    

if __name__ == '__main__':
    main()